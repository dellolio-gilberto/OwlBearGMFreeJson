import{a as f,j as t,u as w}from"./main-Lq5xJYv1.js";import{k as T,i as N}from"./DiceButtonWrapper-DlnuJVpt.js";import{r,as as D,D as P,e as R}from"./diceHelper-DyDajmT-.js";const L=()=>{const e=R(w(a=>a.log)),[s,i]=r.useState(20);return t.jsxs("ul",{className:"roll-log",children:[e.sort((a,l)=>new Date(l.created_at).getTime()-new Date(a.created_at).getTime()).slice(0,s).map((a,l)=>t.jsx(_,{entry:a,classes:l>4?"old-roll":""},a.uuid)),s<e.length?t.jsx("button",{className:"more",onClick:()=>{i(Math.min(s+10,e.length))},children:"more"}):null]})},_=e=>{const s=f(),i=new Date(e.entry.created_at),a=new Date,[l,x]=r.useState(e.entry.is_hidden),c=e.entry.owlbear_user_id===s.id||e.entry.participantUsername===s.name,y=a.getTime()-i.getTime(),m=n=>{const u=Math.floor(n/864e5);if(u>0)return`${u}d`;const d=Math.floor(n%864e5/36e5);if(d>0)return`${d}h`;const h=Math.floor(n%864e5%36e5/6e4);return h>0?`${h}m`:"now"},[g,j]=r.useState(m(y));D(()=>{j(m(new Date().getTime()-i.getTime()))},6e4);const v=r.useCallback(()=>e.entry.values.length>0&&P.isObject(e.entry.values[0])&&e.entry.values[0].hasOwnProperty("value")?e.entry.values.map(n=>l?"?":n.value).join(", ").replace(", +"," + "):e.entry.values.map(n=>l?"?":n).join(", ").replaceAll(", +"," + "),[e.entry.values,l]),b=r.useCallback(()=>{if(e.entry.label){const n=e.entry.label.split(":");return n.length===2?t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"label-name",children:[n[0],":"]}),t.jsx("span",{className:`label-detail ${n[1].trim().toLowerCase().replace(" ","-")}`,children:n[1]})]}):t.jsx("span",{className:"label-name",children:e.entry.label})}else return},[e.entry.label]),o=v();return t.jsxs("li",{className:`roll-log-entry ${e.classes} ${c?"self":""}`,children:[t.jsx("div",{className:"roll-time",children:g}),t.jsx("div",{className:"roll-context",children:b()}),t.jsx("div",{className:"username",children:e.entry.username}),e.entry.equation?t.jsx(T,{dice:e.entry.equation,text:e.entry.equation,stats:{strength:0,dexterity:0,constitution:0,intelligence:0,wisdom:0,charisma:0},context:e.entry.label||"re-roll",statblock:e.entry.username}):null,t.jsx("div",{className:"roll-equation",children:e.entry.equation}),t.jsx(N,{content:o,maxWidth:"100vw",children:t.jsx("div",{className:"detailed-result",children:o})}),o.length>0||e.entry.total_value.length>0?t.jsx("div",{className:"divider",children:"="}):null,t.jsx("div",{className:"total",children:l?"?":String(e.entry.total_value)}),e.entry.is_hidden&&c?t.jsx("button",{className:"hide-toggle",onClick:()=>{x(!l)},children:l?"unhide":"hide"}):null]})};export{L as R,_ as a};
